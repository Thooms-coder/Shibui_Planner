{% extends "layout.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="mb-0">🗓️ Your Daily Planner</h2>
  <a href="{{ url_for('main') }}" class="btn btn-outline-primary">← Home</a>
</div>

<div class="mb-4">
  <h5>
    <strong>Balance Score:</strong>
    <span class="badge bg-info text-dark">{{ balance_score }}</span>
  </h5>
</div>

{% if tasks %}
  {% for task in tasks %}
  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title">
        {{ task.TaskName }}
        <span class="badge bg-secondary float-end">
          {% if task.TaskCategory == 'Flow' %}🧠 Flow{% else %}🏃 Motion{% endif %}
        </span>
      </h5>

      <p class="card-text mb-2">
        <strong>Subcategory:</strong> {{ task.TaskSubcategory }}<br>
        <strong>Status:</strong>
        {{ task.TaskStatus|replace('_',' ')|capitalize }}
      </p>

      <p class="card-text mb-2">
        <strong>Duration:</strong> {{ task.ActualDuration }} min<br>
        <strong>Intensity:</strong> {{ task.FeedbackIntensity }}
      </p>

      <!-- Mood Before Slider (read-only) -->
      <div class="mb-3">
        <label for="mb-{{ task.UserTaskID }}" class="form-label">
          Mood Before: <strong>{{ task.MoodBefore }}</strong>
        </label>
        <input
          type="range"
          class="form-range"
          id="mb-{{ task.UserTaskID }}"
          min="1" max="10"
          value="{{ task.MoodBefore }}"
          disabled
        >
      </div>

      <!-- Mood After Slider (read-only) -->
      <div class="mb-3">
        <label for="ma-{{ task.UserTaskID }}" class="form-label">
          Mood After: <strong>{{ task.MoodAfter }}</strong>
        </label>
        <input
          type="range"
          class="form-range"
          id="ma-{{ task.UserTaskID }}"
          min="1" max="10"
          value="{{ task.MoodAfter }}"
          disabled
        >
      </div>

      <div class="mt-3">
        <a href="{{ url_for('manage_user_task', action='edit', pkval=task.UserTaskID) }}"
           class="btn btn-sm btn-outline-primary">
          ✏️ Edit Task
        </a>
      </div>
    </div>
  </div>
  {% endfor %}
{% else %}
  <p class="text-muted">No tasks scheduled in this mode.</p>
{% endif %}

<div class="mt-4">
  <a href="{{ url_for('manage_user_task', action='new') }}" class="btn btn-success me-2">
    + Add New Task
  </a>
  <a href="{{ url_for('list_feedback') }}" class="btn btn-secondary me-2">
    Give Feedback
  </a>
  <a href="{{ url_for('task_history') }}" class="btn btn-primary">
    📈 View Task History
  </a>
</div>
{% endblock %}


